\documentclass[12pt]{article}
\usepackage[a4paper, includeheadfoot, margin = 1.5cm]{geometry}
\usepackage[unicode=true, colorlinks=true, linkcolor=black, urlcolor=black]{hyperref}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage{csquotes}
\usepackage{indentfirst}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{comment}
\usepackage{mathptmx}
\usepackage{tikz}
\usepackage{bm}
\usepackage{enumitem}
\usepackage{amsthm}
\usepackage{physics}
\usepackage{derivative}
\usepackage{amsmath,amssymb}

%\fontsize{16pt}{20pt}\selectfont
\renewcommand{\sfdefault}{cmss}
\renewcommand{\rmdefault}{cmr}
\renewcommand{\ttdefault}{cmt}

\renewcommand{\thesection}{\Roman{section}} 
%\renewcommand{\thesubsection}{\thesection.\Roman{subsection}}

\newtheorem{definition}{Дефиниция}[section]
\newtheorem{problem}{Задача}
\newtheorem{theorem}{Теорема}
\newtheorem*{theorem*}{Теорема}
\newtheorem{lemma}{Лема}
\newtheorem*{solution*}{Решение}

\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

% Space between lines in array for fractions
\renewcommand{\arraystretch}{1.5}

\title{Решения на задачи по МКЕ 1}

\author{Калоян Стоилов}

\begin{document}

\maketitle
\begin{large}
\begin{problem}
Да се приложи МКЕ с мрежа с възли $\frac{k}{3}, k=\overline{0,3}$ 
\begin{equation}
    \begin{cases}
      -u'' = 1 \\
      u\left(0\right)=u'\left(1\right)=0
    \end{cases}
\end{equation}
\end{problem}

\begin{solution*}
Всъщност за тази задача лесно може да намерим и аналитичното решение:
\begin{align*}
-u'' &= 1 \implies u' = -x + a \implies u = -\frac{x^2}{2} + ax + b \\
-u\left(0\right) &= 0 \implies b = 0 \\
-u'\left(1\right) &= 0 \implies -\frac{2}{2} + a = 0 \implies a=1 \\
\implies u(x) &= -\frac{x^2}{2}+x
\end{align*}

За да приложим МКЕ, умножаваме двете страни по функция $v(x)$ и интегрираме:
\begin{align*}
-\int_{0}^{1}u''(x)v(x)\dd x = \int_{0}^{1}v(x)\dd x \\
\int_{0}^{1}u'(x)v'(x)\dd x - u'\left(1\right)v\left(1\right)+ u'\left(0\right)v\left(0\right) &= \int_{0}^{1}v(x)\dd x \\
\int_{0}^{1}u'(x)v'(x)\dd x = \int_{0}^{1}v(x)\dd x \\
\end{align*}
За да подсигурим последното, ще е необходимо $v\left(0\right)=0$, т.е. $v \in V = \{v \in H^1 \vert v\left(0\right)=0\}$. Билинейната форма за задачата ни е $a\left(f, g\right)=\int_{0}^{1}f'(x)g'(x)\dd x$, а $F\left(v\right)=\int_{0}^{1}v(x)\dd x$. Тъй като трябва $v(0)=0$, то колибката $\varphi_0$ няма да участва в $V_h$, т.е. $V_h = span\{\varphi_1, \varphi_2, \varphi_3\}$,  След проектиране в пространството $V_h$, където за базис взимаме познатите ни функции колибки,  достигаме до системата: 
\begin{equation}
	\begin{pmatrix}
	6 & -3 & 0 \\
	-3 & 6 & -3 \\
	0 & -3 & 3 \\
	\end{pmatrix}
	\begin{pmatrix}
      q_1 \\
      q_2 \\
      q_3
    \end{pmatrix}
    =
    \begin{pmatrix}
      \frac{1}{3} \\
      \frac{1}{3} \\
      \frac{1}{6} \\
    \end{pmatrix}
\end{equation}
Решението е $(q_1, q_2, q_3)^T = (\frac{5}{18}, \frac{4}{9}, \frac{1}{2})^T$.
\end{solution*}

\begin{problem}
Да се приложи МКЕ с мрежа с възли $\frac{k}{3}, k=\overline{0,3}$ 
\begin{equation}
    \begin{cases}
      -\dv{x}(c\left(x\right)\dv{u}{x}\left(x\right)) = \delta\left(x-\frac{1}{2}\right) \\
      u\left(0\right)=u'\left(1\right)=0
    \end{cases} , \quad
    c\left(x\right)
    =
    \begin{cases}
      2, x<\frac{1}{3} \\
      4, x>=\frac{1}{3} \\
    \end{cases} \\
\end{equation}
\end{problem}

\begin{solution*}
За да приложим МКЕ, умножаваме двете страни по функция $v(x)$ и интегрираме:
\begin{align*}
-\int_{0}^{1}\dv{x}(c\left(x\right)\dv{u}{x}\left(x\right))v(x)\dd x = \int_{0}^{1}v(x)\dd x \\
\int_{0}^{1}c\left(x\right)\dv{u}{x}\left(x\right)v'(x)\dd x - c\left(1\right)\dv{u}{x}\left(1\right)v\left(1\right) + c\left(0\right)\dv{u}{x}\left(0\right)v\left(0\right) &= \int_{0}^{1}v(x)\dd x \\
\int_{0}^{1}c\left(x\right)u'(x)v'(x)\dd x = \int_{0}^{1}v(x)\dd x \\
\end{align*}
За да подсигурим последното, ще е необходимо $v\left(0\right)=0$, т.е. $v \in V = \{v \in H^1 \vert v\left(0\right)=0\}$, съответно и $V_h$ е като в предишната задача. Билинейната форма за задачата ни е $a\left(f, g\right)=\int_{0}^{1}c(x)f'(x)g'(x)\dd x$, а $F\left(v\right)=\int_{0}^{1}v(x)\dd x$. След проектиране в пространството $V_h$, където за базис взимаме познатите ни функции колибки,  достигаме до системата: 
\begin{equation}
	\begin{pmatrix}
	18 & -12 & 0 \\
	-12 & 24 & -12 \\
	0 & -12 & 12 \\
	\end{pmatrix}
	\begin{pmatrix}
      q_1 \\
      q_2 \\
      q_3
    \end{pmatrix}
    =
    \begin{pmatrix}
      \frac{1}{2} \\
      \frac{1}{2} \\
      0 \\
    \end{pmatrix}
\end{equation}
Повечето коефициенти се извеждат от предишната задача, но се умножават по $4$, т.к. в съответните интервали $c(x)=4$. Коефициентът $a\left(\varphi_1, \varphi_1\right)$ се получава, като разбием интеграла на две части - отляво и отдясно на точката $\frac{1}{3}$, която е 
Решението е $(q_1, q_2, q_3)^T = (\frac{1}{6}, \frac{5}{24}, \frac{5}{24})^T$.
\end{solution*}
\end{large}
\end{document}
